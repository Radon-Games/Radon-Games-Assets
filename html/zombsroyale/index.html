<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>Zombs Royale - 100 Player 2D Real-Time Battle Royale</title>
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:400,600">
    <link rel="stylesheet" href="asset/app.css" type="text/css">
    <link rel="icon" href="favicon.ico">
    <meta name="description" content="Play ZombsRoyale.io - 100 player 2D real-time massive multiplayer Battle Royale game in your browser, inspired by PUBG/Fortnite.">
    <script>
        window.factorem = {};
        window.factorem.slotSizes =  [
            [[728, 90]],
            [[300, 250]],
            [[300, 250]],
            [[728, 90]],
            [[728, 90]],
            [[300, 250]],
            [[160, 600]],
            [[160, 600]],
        ];
    </script>
    <script>
        window.ga = function(){};
        (function() {
            var origOpen = XMLHttpRequest.prototype.open;
            XMLHttpRequest.prototype.open = function(...args) {
                if(args[1].includes('://zombsroyale.io/api/')){
                    args[1] = 'https://onebigorange-tmm.tbt.mx/normal/'+args[1];
                }
                if(args[1][0] === '/'){
                    args[1] = args[1].slice(1);
                }
                origOpen.apply(this, args);
            };
        })();
        WebAssembly.instantiateStreaming = async function(...args){
            var response = await args[0];
            return WebAssembly.instantiate(await response.arrayBuffer());
        };
        window.realFetch = window.fetch;
        window.fetch = function(...args){
            if(args[0][0] === '/'){
                args[0] = args[0].slice(1);
            }
            return window.realFetch(...args);
        };
        // (async function(){
        //     const dbs = await window.indexedDB.databases();
        //     dbs.forEach(db => window.indexedDB.deleteDatabase(db.name));
        // })();
        window.rWS = window.WebSocket;
        WebSocket = function(url){
            var split = url.split('://');
            
            var prefix = '';
            switch(split[0].toLowerCase()){
                case 'ws': prefix='wss://onebigorange-tmm.tbt.mx/websocket/http://';break;
                case 'wss': prefix='wss://onebigorange-tmm.tbt.mx/websocket/https://';break;
                default: prefix = split[0];
            }
            return new (Function.prototype.bind.call(window.rWS, null, (split[1].match(/\//g) || []).length === 0?(split[1].includes('?')?prefix+split[1].replace('?', '/?'):prefix+split[1]+'/'):prefix+split[1]));
        };
    </script>
</head>

<body class="home">
    <div class="home-loading">
        <div class="home-loading-props">
            <div class="home-loading-tree"></div>
            <div class="home-loading-tree"></div>
            <div class="home-loading-tree"></div>
            <div class="home-loading-player-scar"></div>
            <div class="home-loading-player-regular"></div>
        </div>
        <div class="home-loading-logo"></div>
        <div class="home-loading-tiers">
            <span class="tier-common"></span>
            <span class="tier-uncommon"></span>
            <span class="tier-rare"></span>
            <span class="tier-epic"></span>
            <span class="tier-legendary"></span>
            <span class="tier-mythic"></span>
        </div>
        <div class="home-loading-tip">Tip: Pick up higher quality weapons if you can, they pack more of a punch!</div>
        <div class="home-loading-help">
            <div class="help-box">
                <span class="help-box-images">
                    <span class="help-box-image help-box-image-left" style="background-image:url('asset/image/help-one-left.png');"></span>
                <span class="help-box-image help-box-image-right" style="background-image:url('asset/image/help-one-right.png');"></span>
                </span>
                <span class="help-box-label">
                    <p><strong>WASD</strong> or <strong>Arrow Keys</strong> to move</p>
                    <p><strong>Left Mouse</strong> to fire</p>
                </span>
            </div>
            <div class="help-box">
                <span class="help-box-images">
                    <span class="help-box-image help-box-image-left" style="background-image:url('asset/image/help-two-left.png');"></span>
                <span class="help-box-image help-box-image-right" style="background-image:url('asset/image/help-two-right.png');"></span>
                </span>
                <span class="help-box-label">
                    <p>Break shiny boxes to get loot</p>
                </span>
            </div>
            <div class="help-box">
                <span class="help-box-images">
                    <span class="help-box-image help-box-image-left" style="background-image:url('asset/image/help-three-left.png');"></span>
                <span class="help-box-image help-box-image-right" style="background-image:url('asset/image/help-three-right.png');"></span>
                </span>
                <span class="help-box-label">
                    <p>Press <strong>E</strong> to open doors</p>
                </span>
            </div>
            <div class="help-box">
                <span class="help-box-images">
                    <span class="help-box-image help-box-image-left" style="background-image:url('asset/image/help-four-left.png');"></span>
                <span class="help-box-image help-box-image-right" style="background-image:url('asset/image/help-four-right.png');"></span>
                </span>
                <span class="help-box-label">
                    <p>Press <strong>E</strong> to interact and loot chests</p>
                </span>
            </div>
        </div>
    </div>
    <script src="asset/app.js"></script>
    <script src="asset/build/UnityLoader.js"></script>
    <script>
        fetch('https://onebigstatic-tmm.tbt.mx/shortstatic/https://zombsroyale.io/build/webgl?rand='+Date.now()).then(async response=>{
            function timeout(ms, promise) {
                return new Promise((resolve, reject) => {
                    const timer = setTimeout(() => {
                        reject(new Error('TIMEOUT'))
                    }, ms)
        
                    promise
                        .then(value => {
                            clearTimeout(timer)
                            resolve(value)
                        })
                        .catch(reason => {
                            clearTimeout(timer)
                            reject(reason)
                        })
                })
            }
            var endpoint = 'thesuperstatic.gq';
            var didFail = false;
            try {
                if (await (await timeout(4000, fetch('https://thesuperstatic.gq/cc'))).text() !== 'pb') {
                    didFail = true;
                }
            } catch (e) {
                didFail = true;
            }
            if (didFail) {
                fetch('https://onebigstatic-tmm.tbt.mx/counter/increment?tag=' + encodeURIComponent('onebigstatic'));
                endpoint = 'onebigstatic-tmm.tbt.mx';
            } else {
                fetch('https://onebigstatic-tmm.tbt.mx/counter/increment?tag=' + encodeURIComponent('thesuperstatic'));
            }
            
            var jsonBlob = new Blob([(await response.text()).replace(/:"\\\//g, ':"https://' + endpoint + '/staticsensitive/https://zombsroyale.io/')], {type: 'application/json'});
            var game = new Game({
                stage: 'prod',
                endpoint: 'zombsroyale',
                userData: false,
                buildJsonUrl: window.URL.createObjectURL(jsonBlob),
            });
    
            game.init(function() {
                console.log('Ready to launch!');
            });
        });
    </script>
    <div id="cdm-zone-end"></div>
</body>
</html>
